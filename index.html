<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jogo da Mem√≥ria Digital - In√≠cio</title>

  <!-- Importa o CSS base e responsivo -->
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <main class="container" role="main">
    <section class="start-card" role="region" aria-labelledby="titulo-jogo">

      <!-- LOGO E T√çTULO -->
      <div class="brand" aria-hidden="false">
        <figure class="logo" aria-hidden="true">
          <!-- Logotipo minimalista -->
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Logotipo Jogo da Mem√≥ria Digital">
            <rect x="6" y="6" width="88" height="88" rx="12" fill="#0F1724" opacity="0.06"/>
            <g transform="translate(10,10)" stroke="#0F1724" stroke-width="4" stroke-linecap="round" stroke-linejoin="round">
              <rect x="0" y="0" width="40" height="40" rx="6" fill="#7DD3FC"/>
              <rect x="46" y="0" width="40" height="40" rx="6" fill="#FB7185"/>
              <rect x="0" y="46" width="40" height="40" rx="6" fill="#FDE68A"/>
              <rect x="46" y="46" width="40" height="40" rx="6" fill="#34D399"/>
            </g>
          </svg>
        </figure>

        <div>
          <h1 id="titulo-jogo">Jogo da Mem√≥ria Digital</h1>
          <p class="lead">Memorize, combine pares e ven√ßa o tabuleiro ‚Äî simples, r√°pido e divertido.</p>
        </div>
      </div>

      <!-- BOT√ïES -->
      <div class="actions" aria-hidden="false">
        <button id="startBtn" class="btn btn-primary" aria-describedby="instrucoes" title="Iniciar Jogo">üéÆ Iniciar</button>
        <button id="historyBtn" class="btn btn-secondary" aria-label="Ver hist√≥rico de partidas">üìä Hist√≥rico</button>
        <button id="howBtn" class="btn btn-ghost" aria-expanded="false" aria-controls="instrucoes">‚ùì Como Jogar</button>
      </div>

      <!-- INSTRU√á√ïES -->
      <div id="instrucoes" class="instructions" role="region" aria-labelledby="label-instrucoes">
        <div style="flex:1;">
          <h2 id="label-instrucoes" style="font-size:15px;margin:0 0 8px 0;">Instru√ß√µes r√°pidas</h2>
          <div class="steps" id="stepsList">
            <div class="step">
              <span class="dot" aria-hidden="true"></span>
              <div><strong>Objetivo:</strong> Encontrar todos os pares virando duas cartas por vez.</div>
            </div>
            <div class="step">
              <span class="dot" aria-hidden="true"></span>
              <div><strong>Pontua√ß√£o:</strong> Menos tentativas aumentam sua pontua√ß√£o.</div>
            </div>
            <div class="step">
              <span class="dot" aria-hidden="true"></span>
              <div><strong>N√≠veis:</strong> Selecione dificuldade depois de iniciar (F√°cil/M√©dio/Dif√≠cil).</div>
            </div>
            <div class="step">
              <span class="dot" aria-hidden="true"></span>
              <div><strong>Hist√≥rico:</strong> Acompanhe seu desempenho nas partidas anteriores.</div>
            </div>
          </div>

          <footer class="meta" aria-hidden="false">
            <span>Tempo estimado de partida: 2‚Äì5 minutos</span>
            <span>Vers√£o: 1.1</span>
          </footer>
        </div>
      </div>
    </section>
  </main>

  <!-- JAVASCRIPT DA TELA INICIAL -->
  <script>
    // JavaScript para tela inicial - ATUALIZADO COM HIST√ìRICO
    const startBtn = document.getElementById('startBtn');
    const historyBtn = document.getElementById('historyBtn');
    const howBtn = document.getElementById('howBtn');

    // Bot√£o "Iniciar": redireciona para o tabuleiro
    startBtn.addEventListener('click', () => {
      window.location.href = 'game.html';
    });

    // Bot√£o "Hist√≥rico": mostra hist√≥rico na tela inicial
    historyBtn.addEventListener('click', () => {
      showHistoryOnHome();
    });

    // Bot√£o "Como Jogar": rola suavemente at√© as instru√ß√µes
    howBtn.addEventListener('click', () => {
      const instrucoes = document.getElementById('instrucoes');
      instrucoes.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });

    // ‚úÖ FUN√á√ÉO PARA MOSTRAR HIST√ìRICO NA TELA INICIAL
    function showHistoryOnHome() {
      try {
        const history = JSON.parse(localStorage.getItem('memoryGameHistory') || '[]');
        
        const historyHTML = `
          <div class="history-overlay">
            <div class="history-card">
              <div class="history-header">
                <h2>üìä Hist√≥rico de Partidas</h2>
                <button class="btn-close" onclick="closeHistoryOnHome()" aria-label="Fechar hist√≥rico">
                  √ó
                </button>
              </div>
              
              <div class="history-content">
                ${history.length === 0 ? 
                  '<div class="empty-history">üéØ Nenhuma partida registrada ainda.<br><br>Jogue uma partida para ver seu hist√≥rico de desempenho!</div>' : 
                  generateHistoryList(history)
                }
              </div>
              
              <div class="history-actions">
                ${history.length > 0 ? 
                  `<button onclick="clearGameHistory()" class="btn btn-danger">
                    üóëÔ∏è Limpar Hist√≥rico
                  </button>` : 
                  ''
                }
                <button onclick="closeHistoryOnHome()" class="btn btn-ghost">
                  Fechar
                </button>
              </div>
            </div>
          </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', historyHTML);
      } catch (error) {
        console.error('Erro ao carregar hist√≥rico:', error);
        alert('Erro ao carregar hist√≥rico de partidas.');
      }
    }

    // ‚úÖ FUN√á√ïES AUXILIARES PARA A TELA INICIAL
    function generateHistoryList(history) {
      return `
        <div class="history-list">
          ${history.map((game, index) => `
            <div class="history-item ${index === 0 ? 'recent' : ''}">
              <div class="history-game-info">
                <div class="game-main-stats">
                  <span class="game-score">${game.score} pts</span>
                  <span class="game-difficulty badge-${game.difficulty}">${getDifficultyName(game.difficulty)}</span>
                </div>
                <div class="game-details">
                  <span>${game.moves} jogadas</span>
                  <span>‚Ä¢</span>
                  <span>${game.time}</span>
                  <span>‚Ä¢</span>
                  <span>${game.efficiency}% efici√™ncia</span>
                </div>
                <div class="game-date">
                  ${formatDate(game.date)}
                </div>
              </div>
              <div class="history-rank">
                #${index + 1}
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }

    function getDifficultyName(difficulty) {
      const names = { 
        easy: 'F√°cil', 
        medium: 'M√©dio', 
        hard: 'Dif√≠cil' 
      };
      return names[difficulty] || difficulty;
    }

    function formatDate(dateString) {
      try {
        const date = new Date(dateString);
        return date.toLocaleDateString('pt-BR', {
          day: '2-digit', 
          month: '2-digit', 
          year: 'numeric',
          hour: '2-digit', 
          minute: '2-digit'
        });
      } catch (error) {
        return 'Data inv√°lida';
      }
    }

    function closeHistoryOnHome() {
      const historyOverlay = document.querySelector('.history-overlay');
      if (historyOverlay) {
        historyOverlay.remove();
      }
    }

    function clearGameHistory() {
      if (confirm('Tem certeza que deseja limpar todo o hist√≥rico de partidas?\n\nEsta a√ß√£o n√£o pode ser desfeita.')) {
        try {
          localStorage.removeItem('memoryGameHistory');
          closeHistoryOnHome();
          // Mostrar notifica√ß√£o de sucesso
          showNotification('Hist√≥rico limpo com sucesso!');
          // Recarregar hist√≥rico vazio
          setTimeout(showHistoryOnHome, 500);
        } catch (error) {
          alert('Erro ao limpar hist√≥rico.');
        }
      }
    }

    function showNotification(message) {
      // Criar notifica√ß√£o simples
      const notification = document.createElement('div');
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--success);
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        z-index: 3000;
        animation: slideInRight 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => {
          if (notification.parentNode) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Acessibilidade: tecla Enter ou espa√ßo inicia o jogo
    document.addEventListener('keydown', (e) => {
      if ((e.key === 'Enter' || e.key === ' ') && document.activeElement === startBtn) {
        e.preventDefault();
        startBtn.click();
      }
      
      // Acessibilidade para bot√£o de hist√≥rico
      if ((e.key === 'Enter' || e.key === ' ') && document.activeElement === historyBtn) {
        e.preventDefault();
        historyBtn.click();
      }
    });

    // Anima√ß√µes CSS din√¢micas para notifica√ß√µes
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      @keyframes slideOutRight {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }
      
      .btn-secondary {
        background: var(--muted);
        color: white;
        border: none;
      }
      
      .btn-secondary:hover {
        background: #4b5563;
        transform: translateY(-1px);
      }
      
      .btn-danger {
        background: var(--danger);
        color: white;
        border: none;
      }
      
      .btn-danger:hover {
        background: #dc2626;
        transform: translateY(-1px);
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>